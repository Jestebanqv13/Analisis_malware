
# Importa la funcion analyze_file de el modulo analyzer.py
from src.analyzer import archivo_analisis
# importamos os
import os


def main():
    # aqui se van a guardar las muestras de malware
    folder_muestras_de_malware = "samples"
    # aqui se van a guardar los reporte de los analisis de malware
    reportes_folder = "reports"

    # Este if se asegura que la carpeta de reportes existe
    if not os.path.exists(reportes_folder):
        os.makedirs(reportes_folder)

    # asi que este los archivos en la carpeta de muestras esten iterados
    for filename in os.listdir(folder_muestras_de_malware):
        ruta_del_archivo = os.path.join(folder_muestras_de_malware, filename)

        # Verifica que el objeto sea un archivo
        if os.path.isfile(ruta_del_archivo):
            # llama la funcion desde el archivo analyze_file para analizar
            resultado = archivo_analisis(ruta_del_archivo)

            # Imprime el resultado
            print(resultado)

            # Define la ruta para guardar el reporte en un archivo de texto
            ruta_del_reporte = os.path.join(
                reportes_folder, f"{filename}_reporte.txt")
            with open(ruta_del_reporte, "w") as archivo_reporte:
                archivo_reporte.write(str(resultado))

    if __name__ == "__main__":
        main()  # Llama a la funcion main si el script se ejecuta directamente
