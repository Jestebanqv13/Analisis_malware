import os
import pefile

# Función para analizar archivos ejecutables


def archivo_analisis(ruta_del_archivo):
    try:
        # Acá se abre el archivo
        pe = pefile.PE(ruta_del_archivo)
        #
        return {
            # "File_name" = Nombre del archivo, mediante
            # "os.path.basename(ruta_del_archivo)"
            "Nombre del Archivo": os.path.basename(ruta_del_archivo),
            # "Import entries" = Almacena entradas de importación, basicamente
            # ve que de que funciones o bibliotecas
            # depende, ya sea del SO o externas
            "Importar entradas": len(pe.DIRECTORY_ENTRY_IMPORT),

        }
    # Excepcion en caso de error en el análisis
    except Exception as e:
        return {"error": f"Error en el análisis  de {ruta_del_archivo}:{e}"}
